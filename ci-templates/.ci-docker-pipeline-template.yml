# Modèle de pipeline Docker utilisant des jobs réutilisables
# Organise les 3 étapes : build, run et push

##### Upstream variables ##### 
# Les variables suivantes doivent être définies ici OU dans l'appelant
#
#   IMAGENAME:      nom de l'image Docker (et du dossier contenant le code source)
#   TAG:            tag de l'image Docker (par exemple, $CI_COMMIT_SHORT_SHA ou "latest")
#   HOSTPORT:       port exposé sur l'hôte pour accéder au service via Docker
#   CONTAINERPORT:  port exposé dans le conteneur Docker
#   URL_PATH:        chemin URL pour vérifier que le service est bien démarré (ex: "api/v1/healthz")
#


include:
  - local: '/ci-templates/.ci-docker-jobs-templates.yml'

stages:
  - build
  - run
  - push

build:
  extends: .build_template

run:
  extends: .run_template

push:
  extends: .push_template
